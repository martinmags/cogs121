<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Profile</title>
  <link rel="stylesheet" href="css/cssreset.css">
  <link rel="stylesheet" href="css/profile.css">

  <script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-firestore.js"></script>

  <!-- GitHub Fetch API -->
  <script src="./js/fetch.umd.js"></script>

  <script>
    // Initialize Cloud Firestore through Firebase
    firebase.initializeApp({
      apiKey: "AIzaSyC6FPXu3_bOHpHr7AelgBKAMbGiIUPZ2Vo",
      authDomain: "pandaexpressjs.firebaseapp.com",
      projectId: "pandaexpressjs"
    });

    var db = firebase.firestore();

    window.onload = function () {
      fetch('/profile')
        .then(res => res.json())
        .then(function (data) {
          if (data) {
            console.log("User logged in. UID: ", data);
            db.collection("users").doc(data)
              .onSnapshot(function (doc) {
                document.getElementById('span-alias').innerHTML = doc.data().alias;
                document.getElementById('span-name').innerHTML = doc.data().name;
                document.getElementById('span-ig').innerHTML = doc.data().ig;
                document.getElementById('span-email').innerHTML = doc.data().email;
                document.getElementById('span-portfolio').innerHTML = doc.data().portfolio;
              });
          }
        }).catch(function (error) {
          console.log("Request failed", error)
        })
    };
  </script>
</head>

<body>
  <div class="screen_container">

    <div class="header_container">
      <div id="invisible-spacer">
        <h1>.</h1>
      </div>
      <div id="header-title">
        <header>PROFILE</header>
      </div>
      <div id="edit_container">
        <a href="EditProfile.html">
          <button id="edit-btn">Edit</button>
        </a>
      </div>
    </div>

    <div class="main_container">
      <div class="text_container">
          <text id="sub-header"><span id="span-name">NAME HERE</span></text>
          <text id="info-text"><span id="span-alias">Alias here</span></text>
          <text id="info-text"><span id="span-ig">@instagram</span></text>
          <text id="info-text"><span id="span-email">email@ucsd.edu</span></text>
          <text id="info-text"><span id="span-portfolio">portfolio.com</span></text>
        </div>
    </div>

    <div class="work_container">
      <!-- n submissions -->
      <div id="submission">
        <Text>Prompt 1</Text>
        <div class="image_container">
          <a class="photo">
            <div id="photos"></div>
          </a>
        </div>
      </div>

      <div id="submission">
        <Text>Prompt 2</Text>
        <div class="image_container">
          <a class="photo">
            <div id="photos"></div>
          </a>
        </div>
        <Text>#First-Place</Text>
      </div>

      <div id="submission">
        <Text>Prompt 3</Text>
        <div class="image_container">
          <a class="photo">
            <div id="photos"></div>
          </a>
        </div>
      </div>

      <div id="submission">
        <Text>Prompt 4</Text>
        <div class="image_container">
          <a class="photo">
            <div id="photos"></div>
          </a>
        </div>
      </div>
    </div>

    <footer class="footer_container">
      <a class="footer_button" href="Search.html">SEARCH</a>
      <a class="footer_button" href="Discover.html">DISCOVER</a>
      <a class="footer_button" href="Profile.html">MY PROFILE</a>
    </footer>

</html>

</html>
